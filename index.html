<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³ÙˆÙ‚ Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ± Ø§Ù„Ù…ÙØªÙˆØ­ | Ù…Ù†ØµØ© Ø§Ù„Ø¨ÙŠØ¹ ÙˆØ§Ù„Ø´Ø±Ø§Ø¡</title>
    
    <!-- Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Ø±ÙˆØ§Ø¨Ø· Ø£Ø³Ø§Ø³ÙŠØ© Ù„ØªØ·Ø¨ÙŠÙ‚ PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#10b981">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Ø±ÙˆØ§Ø¨Ø· Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="responsive.css">
    
    <!-- Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© -->
    <style>
        :root {
            --primary-color: #10b981;
            --secondary-color: #3b8276;
            --accent-color: #f59e0b;
            --dark-color: #1f2937;
            --light-color: #f9fafb;
        }
        
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f5f5f5;
            padding-top: 80px;
            margin: 0;
            min-height: 100vh;
        }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ */
        .main-nav {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 1rem 0;
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø¬ÙˆØ§Ù„ */
        @media (max-width: 768px) {
            body {
                padding-top: 70px;
            }
            
            .main-nav {
                padding: 0.75rem 0;
            }
        }
        
        /* Ø±Ø³Ø§Ù„Ø© ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ */
        .pwa-install-prompt {
            display: none;
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            z-index: 9999;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ -->
    <nav class="main-nav">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <a class="navbar-brand fw-bold text-primary" href="#">
                    <i class="bi bi-shop me-2"></i>Ø³ÙˆÙ‚ Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ± Ø§Ù„Ù…ÙØªÙˆØ­
                </a>
                <div class="d-flex gap-3">
                    <button class="btn btn-outline-primary" id="installBtn" style="display: none;">
                        <i class="bi bi-download me-2"></i>ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
                    </button>
                    <a href="#" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-2"></i>Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù†
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <main class="container py-4">
        <!-- Ø³ÙŠØªÙ… ÙˆØ¶Ø¹ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù‡Ù†Ø§ -->
        <div id="app-content">
            <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡ Ù‡Ù†Ø§ -->
        </div>
    </main>

    <!-- Ø±Ø³Ø§Ù„Ø© ØªØ«Ø¨ÙŠØª PWA -->
    <div id="pwaPrompt" class="pwa-install-prompt">
        <h6 class="mb-2">ØªØ«Ø¨ÙŠØª ØªØ·Ø¨ÙŠÙ‚ Ø³ÙˆÙ‚ Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ±</h6>
        <p class="text-muted small mb-3">Ø«Ø¨Ù‘Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹ ÙˆØªØ¬Ø±Ø¨Ø© Ø£ÙØ¶Ù„</p>
        <div class="d-flex gap-2 justify-content-center">
            <button class="btn btn-sm btn-outline-secondary" id="cancelInstall">Ù„Ø§Ø­Ù‚Ø§Ù‹</button>
            <button class="btn btn-sm btn-primary" id="confirmInstall">ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¢Ù†</button>
        </div>
    </div>

    <!-- Ø±ÙˆØ§Ø¨Ø· JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Ù…Ù„ÙØ§Øª JavaScript Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
    <script src="auth.js"></script>
    <script src="ads.js"></script>
    <script src="app.js"></script>
    
    <!-- ØªÙ‡ÙŠØ¦Ø© PWA ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
    <script>
        // ÙƒØ´Ù ÙˆØ¥Ø¯Ø§Ø±Ø© ØªØ«Ø¨ÙŠØª PWA
        window.addEventListener('DOMContentLoaded', () => {
            // Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª
            const installBtn = document.getElementById('installBtn');
            const pwaPrompt = document.getElementById('pwaPrompt');
            const cancelInstall = document.getElementById('cancelInstall');
            const confirmInstall = document.getElementById('confirmInstall');
            
            let deferredPrompt;
            
            // ÙƒØ´Ù Ø­Ø¯Ø« Ù‚Ø¨Ù„ Ø§Ù„ØªØ«Ø¨ÙŠØª
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                
                // Ø¹Ø±Ø¶ Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª
                installBtn.style.display = 'block';
                pwaPrompt.style.display = 'block';
                
                // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª
                installBtn.addEventListener('click', () => {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('âœ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„ØªØ«Ø¨ÙŠØª');
                        } else {
                            console.log('âŒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø±ÙØ¶ Ø§Ù„ØªØ«Ø¨ÙŠØª');
                        }
                        deferredPrompt = null;
                    });
                });
                
                // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
                confirmInstall.addEventListener('click', () => {
                    deferredPrompt.prompt();
                    pwaPrompt.style.display = 'none';
                });
                
                // Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ«Ø¨ÙŠØª
                cancelInstall.addEventListener('click', () => {
                    pwaPrompt.style.display = 'none';
                });
            });
            
            // ÙƒØ´Ù Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø«Ø¨ØªØ§Ù‹ Ø¨Ø§Ù„ÙØ¹Ù„
            if (window.matchMedia('(display-mode: standalone)').matches) {
                console.log('âœ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ¹Ù…Ù„ ÙÙŠ ÙˆØ¶Ø¹ standalone');
                installBtn.style.display = 'none';
            }
            
            // ÙƒØ´Ù Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
            window.addEventListener('online', () => {
                console.log('âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª');
                document.body.classList.remove('offline');
            });
            
            window.addEventListener('offline', () => {
                console.log('âš ï¸ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª');
                document.body.classList.add('offline');
                alert('âš ï¸ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. Ø¨Ø¹Ø¶ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ù‚Ø¯ Ù„Ø§ ØªØ¹Ù…Ù„.');
            });
        });
        
        // ØªØ³Ø¬ÙŠÙ„ Service Worker Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('âœ… Service Worker Ù…Ø³Ø¬Ù„ Ø¨Ù†Ø¬Ø§Ø­:', registration.scope);
                    })
                    .catch(error => {
                        console.log('âŒ ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Service Worker:', error);
                    });
            });
        }
    </script>
<!-- Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… PWA Ù…Ø¨Ø³Ø·Ø© Ù„Ù„Ù‡Ø§ØªÙ -->
<div style="position:fixed; bottom:10px; left:10px; background:white; padding:10px; border-radius:5px; box-shadow:0 0 10px rgba(0,0,0,0.3); z-index:9999; max-width:300px; display:none;" id="pwaDebug">
    <h6 style="margin:0 0 10px 0;">ğŸ”§ PWA Debug</h6>
    <div id="debugInfo" style="font-size:12px;"></div>
    <button onclick="document.getElementById('pwaDebug').style.display='none'" style="margin-top:5px; font-size:10px;">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<script>
// ÙƒÙˆØ¯ ÙØ­Øµ PWA Ù„Ù„Ù‡Ø§ØªÙ
function checkPWA() {
    let info = '';
    
    // 1. ÙØ­Øµ Manifest
    if (document.querySelector('link[rel="manifest"]')) {
        info += 'âœ… Manifest Ù…ÙˆØ¬ÙˆØ¯<br>';
    } else {
        info += 'âŒ Manifest Ù…ÙÙ‚ÙˆØ¯<br>';
    }
    
    // 2. ÙØ­Øµ Service Worker
    if ('serviceWorker' in navigator) {
        info += 'âœ… Service Worker Ù…Ø¯Ø¹ÙˆÙ…<br>';
        navigator.serviceWorker.getRegistration()
            .then(reg => {
                if (reg) {
                    info += 'âœ… SW Ù…Ø³Ø¬Ù„<br>';
                } else {
                    info += 'âŒ SW ØºÙŠØ± Ù…Ø³Ø¬Ù„<br>';
                }
                updateDebugInfo(info);
            });
    } else {
        info += 'âŒ Service Worker ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…<br>';
    }
    
    // 3. ÙØ­Øµ ÙˆØ¶Ø¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    if (window.matchMedia('(display-mode: standalone)').matches) {
        info += 'âœ… ÙŠØ¹Ù…Ù„ ÙƒØªØ·Ø¨ÙŠÙ‚ Ù…Ø«Ø¨Øª<br>';
    } else if (window.navigator.standalone) {
        info += 'âœ… Ù…Ø«Ø¨Øª Ø¹Ù„Ù‰ iOS<br>';
    } else {
        info += 'ğŸ“± ÙŠØ¹Ù…Ù„ ÙƒÙ…ØªØµÙØ­ Ø¹Ø§Ø¯ÙŠ<br>';
    }
    
    // 4. ÙØ­Øµ Ø§Ù„Ø§ØªØµØ§Ù„
    info += navigator.onLine ? 'ğŸŒ Ø§ØªØµØ§Ù„ Ù†Ø´Ø·<br>' : 'ğŸ“´ ØºÙŠØ± Ù…ØªØµÙ„<br>';
    
    updateDebugInfo(info);
}

function updateDebugInfo(text) {
    document.getElementById('debugInfo').innerHTML = text;
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„ÙØ­Øµ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
setTimeout(checkPWA, 1000);

// Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù„Ù…Ø³ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬
let tapCount = 0;
let lastTap = 0;
document.addEventListener('touchstart', function(e) {
    const currentTime = new Date().getTime();
    const tapLength = currentTime - lastTap;
    
    if (tapLength < 500 && tapLength > 0) {
        tapCount++;
        if (tapCount === 2) { // Ø«Ù„Ø§Ø« Ù†Ù‚Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø©
            const debugPanel = document.getElementById('pwaDebug');
            debugPanel.style.display = debugPanel.style.display === 'none' ? 'block' : 'none';
            tapCount = 0;
        }
    } else {
        tapCount = 1;
    }
    lastTap = currentTime;
});
</script></body><!-- Ø²Ø± ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
<div id="installContainer" style="display:none; position:fixed; bottom:20px; left:20px; z-index:10000;">
    <button id="installButton" 
            style="background:#10b981; color:white; border:none; padding:12px 20px; border-radius:25px; font-weight:bold; box-shadow:0 4px 12px rgba(16, 185, 129, 0.3);">
        ğŸ“² ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    </button>
</div>

<script>
// Ø¹Ø±Ø¶ Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª Ø¹Ù†Ø¯ ØªÙˆÙØ± Ø§Ù„Ø¥Ù…ÙƒØ§Ù†ÙŠØ©
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    document.getElementById('installContainer').style.display = 'block';
});

// Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª
document.getElementById('installButton').addEventListener('click', () => {
    if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
                document.getElementById('installContainer').style.display = 'none';
            }
            deferredPrompt = null;
        });
    }
});
</script>
</html>