// ØªØ·Ø¨ÙŠÙ‚ Ø³ÙˆÙ‚ Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ± - Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
console.log('ğŸš€ ØªØ·Ø¨ÙŠÙ‚ Ø³ÙˆÙ‚ Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ± ÙŠØ¹Ù…Ù„!');

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
document.addEventListener('DOMContentLoaded', function() {
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø©
    initMobileMenu();
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
    loadLatestAds();
    
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
    initForms();
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± ØªØ±Ø­ÙŠØ¨ÙŠ
    showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø³ÙˆÙ‚ Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ±!', 'success');
});

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø©
function initMobileMenu() {
    const menuToggle = document.getElementById('menuToggle');
    const navMenu = document.getElementById('navMenu');
    
    if (menuToggle && navMenu) {
        menuToggle.addEventListener('click', () => {
            navMenu.classList.toggle('active');
        });
        
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
        document.addEventListener('click', (e) => {
            if (!menuToggle.contains(e.target) && !navMenu.contains(e.target)) {
                navMenu.classList.remove('active');
            }
        });
    }
}

// ØªØ­Ù…ÙŠÙ„ Ø£Ø­Ø¯Ø« Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
function loadLatestAds() {
    const adsGrid = document.getElementById('adsGrid');
    if (!adsGrid) return;

    // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
    const sampleAds = [
        {
            id: 1,
            title: "Ø³ÙŠØ§Ø±Ø© ØªÙˆÙŠÙˆØªØ§ ÙƒØ§Ù…Ø±ÙŠ 2020",
            price: "85,000 Ø±ÙŠØ§Ù„",
            location: "Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ± - Ø­ÙŠ Ø§Ù„Ø¬ÙˆØ±Ø©",
            image: "https://via.placeholder.com/400x300/4CAF50/FFFFFF?text=Ø³ÙŠØ§Ø±Ø©",
            category: "Ø³ÙŠØ§Ø±Ø§Øª"
        },
        {
            id: 2,
            title: "Ø´Ù‚Ø© Ù„Ù„Ø¥ÙŠØ¬Ø§Ø± 3 ØºØ±Ù",
            price: "2,500 Ø±ÙŠØ§Ù„/Ø´Ù‡Ø±",
            location: "Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ± - Ø­ÙŠ Ø§Ù„Ø«ÙˆØ±Ø©",
            image: "https://via.placeholder.com/400x300/2196F3/FFFFFF?text=Ø¹Ù‚Ø§Ø±",
            category: "Ø¹Ù‚Ø§Ø±Ø§Øª"
        },
        {
            id: 3,
            title: "Ø¬ÙˆØ§Ù„ Ø¢ÙŠÙÙˆÙ† 13 Ø¨Ø±Ùˆ",
            price: "4,200 Ø±ÙŠØ§Ù„",
            location: "Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ± - Ø­ÙŠ Ø§Ù„Ù…Ø·Ø§Ø±",
            image: "https://via.placeholder.com/400x300/FF9800/FFFFFF?text=Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
            category: "Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª"
        },
        {
            id: 4,
            title: "Ø¹Ù…Ù„ ÙÙŠ Ù…Ø·Ø¹Ù…",
            price: "3,000 Ø±ÙŠØ§Ù„/Ø´Ù‡Ø±",
            location: "Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ± - Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©",
            image: "https://via.placeholder.com/400x300/9C27B0/FFFFFF?text=ÙˆØ¸ÙŠÙØ©",
            category: "ÙˆØ¸Ø§Ø¦Ù"
        },
        {
            id: 5,
            title: "Ø®Ø¯Ù…Ø© Ù†Ù‚Ù„ Ø£Ø«Ø§Ø«",
            price: "Ø³Ø¹Ø± Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ©",
            location: "Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ± - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø­ÙŠØ§Ø¡",
            image: "https://via.placeholder.com/400x300/00BCD4/FFFFFF?text=Ø®Ø¯Ù…Ø©",
            category: "Ø®Ø¯Ù…Ø§Øª"
        },
        {
            id: 6,
            title: "Ø£Ø«Ø§Ø« Ù…Ù†Ø²Ù„ÙŠ ÙƒØ§Ù…Ù„",
            price: "7,500 Ø±ÙŠØ§Ù„",
            location: "Ø¯ÙŠØ± Ø§Ù„Ø²ÙˆØ± - Ø­ÙŠ Ø§Ù„Ø±ÙˆØ¶Ø©",
            image: "https://via.placeholder.com/400x300/795548/FFFFFF?text=Ø£Ø«Ø§Ø«",
            category: "Ù…Ù†Ø²Ù„"
        }
    ];

    // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
    adsGrid.innerHTML = sampleAds.map(ad => `
        <div class="ad-card" onclick="viewAd(${ad.id})">
            <img src="${ad.image}" alt="${ad.title}" class="ad-image">
            <div class="ad-content">
                <h3 class="ad-title">${ad.title}</h3>
                <div class="ad-price">${ad.price}</div>
                <div class="ad-location">
                    <i class="fas fa-map-marker-alt"></i> ${ad.location}
                </div>
                <div class="ad-category">${ad.category}</div>
            </div>
        </div>
    `).join('');
}

// Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
function viewAd(adId) {
    showNotification(`Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø±Ù‚Ù… ${adId}...`, 'info');
    // Ù‡Ù†Ø§ Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
    window.location.href = `pages/ad-details.html?id=${adId}`;
}

// ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù†
function openAddAdModal() {
    const user = JSON.parse(localStorage.getItem('soug_user'));
    if (!user) {
        showNotification('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'warning');
        openLoginModal();
        return;
    }
    
    // Ù‡Ù†Ø§ Ø³ÙŠØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù†
    showNotification('Ø¬Ø§Ø±ÙŠ ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù†...', 'info');
}

// Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø±
function showNotification(message, type = 'info') {
    const container = document.getElementById('notificationContainer');
    if (!container) return;
    
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.innerHTML = `
        <div class="notification-content">
            <i class="fas fa-${type === 'success' ? 'check-circle' : 
                            type === 'error' ? 'exclamation-circle' : 
                            type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
            <span>${message}</span>
        </div>
    `;
    
    container.appendChild(notification);
    
    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => notification.remove(), 300);
    }, 5000);
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
function initForms() {
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    
    if (loginForm) {
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            handleLogin();
        });
    }
    
    if (registerForm) {
        registerForm.addEventListener('submit', function(e) {
            e.preventDefault();
            handleRegister();
        });
    }
}

// Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
function openLoginModal() {
    document.getElementById('loginModal').style.display = 'flex';
}

function closeLoginModal() {
    document.getElementById('loginModal').style.display = 'none';
}

function openRegisterModal() {
    closeLoginModal();
    document.getElementById('registerModal').style.display = 'flex';
}

function closeRegisterModal() {
    document.getElementById('registerModal').style.display = 'none';
}

// Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
window.onclick = function(event) {
    const loginModal = document.getElementById('loginModal');
    const registerModal = document.getElementById('registerModal');
    
    if (event.target === loginModal) {
        closeLoginModal();
    }
    if (event.target === registerModal) {
        closeRegisterModal();
    }
};

// Service Worker Ù„Ù„ØªØ·Ø¨ÙŠÙ‚
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
            .then(registration => {
                console.log('ServiceWorker registered:', registration);
            })
            .catch(error => {
                console.log('ServiceWorker registration failed:', error);
            });
    });
}